
## 会议议题

- X行POC测试情况介绍及讨论
- POC过程中存在的问题及改进方案
## 会议结论
### 标准解决方案

- X版本做系统性疲劳测试；Y版本做关键组件的疲劳测试。疲劳测试参照X行标准。
### 非功能测试

- 参考X行标准，整理并输出**标准非功能测试方案**

### POC解决方案

   - 针对POC的场景，梳理并规范化一套“短平快”的解决方案
   - 人力评估：4个人左右（1交付+1sde+1sc+1项目经理，如果是功能测试增加1产品）
### POC问题跟进
#### 前期准备

- 准备阶段
   - 确认机器信息
   - 根据机器信息，给出制品包（落实到人）
   - 制品包安装内部自测（落实到人）
- 部署包信息
   - 保障所有部署包为离线版本
   - 所有服务用到的监控、exporter及dashboard齐全
   - 针对CDH，需要一份操作系统兼容性评估报告
- 冲刺阶段
   - 确认入场时间
   - POC预演
      - 服务部署规划（需要具体到组件包级别）
      - 任务、角色分配，确认人员配置
      - 沟通时间节点预定义（测试到什么阶段进行测试结果沟通）
#### 部署文档完善

- 部署脚本完善
- 增加服务器必要配置
   - 防火墙关闭
   - 所有服务器免密配置
   - ntp配置
   - 透明大页、句柄数、jdk17参数
- 增加常用工具包（全部为离线版本）
   - arthas
   - jmeter
   - gcviewer
   - 数据库客户端
#### 部署方式规范

- 所有文件统一上传，通过分发方式，传输到各个服务器
- 所有组件部署，需要检查盘符空间
   - kafka部署，关注data存储位置
   - hdfs部署，关注存储位置
- 当存在功能环境和性能环境时，需要对中间件进行资源隔离，避免相互影响
   - zk、kafka、as
#### 测试阶段

- 优先根据测试方案，形成详细测试计划，合理安排测试步骤，最大化利用资源
- 测试过程中的所有日志需要规范化命名并流程，形成闭环，便于后续信息统计
- 测试过程中异常情况及时关注解决（如cpu波动、tps波动）
#### 报告编写阶段

- 组件部署架构设计
- 需要预留充分时间
- 编写过程中，交叉验证报告
- 报告不仅是结果呈现，要有异常解释和结论
#### 沟通

- 对内
   - 技术：明确测试方案、非功能指标要求
   - 产品：明确客户功能关注、性能指标要求下的规则、指标、事件、测试数据设计
- 对外
   - 及时反馈阶段性测试情况
### 决策平台

- 新增通过批量生成指标及规则的功能
   - 该功能用于POC场景，需要大量指标、规则配置时
   - 可采用通过excel模板上传的方式实现
### 遗留问题跟进
#### 引擎

- 引擎多节点CPU资源使用不平均
- 4台引擎组成的集群，高可用测试中，单台引擎节点重启后，TPS会高于初始启动
- 引擎的CPU利用率较低
   - 原因猜测：
      - 序列化导致cpu无法提升，可能存在类锁？
      - 重复正反序列化影响其他线程？
      - numa调优未进行？
   - 验证方式：
      - 自己写一个小程序，查询redis或as，观察当TPS提升时，延时是否会有上升
#### 计算

- 集群中一个节点kill掉时，qps下降明显
#### jmeter

- Jmeter的jtl日志中延时统计结果与服务内部日志统计差异较大（2-3ms的差距）
### 组件优化
#### 引擎

- 引擎需要前置字段型判断，根据事件字段可以直接进行判断的，无需执行指标查询
- 引擎查询指标按需加载
- 同一批次查询中，相同查询合并，减少报文大小
#### 计算

- 针对同一批次中，仅时间窗口不同的指标查询，进行合并，只查一次
## 执行计划
> 设置后续待办任务，可使用 @人分配执行人。

- [ ] 标准化解决方案
- [ ] 针对X版本进行全系统疲劳测试
- [ ] 针对Y版本进行关键组件疲劳测试
- [ ] 标准化非功能测试方案
- [ ] 标准化POC解决方案
- [ ] 部署文档完善
- [ ] 角色分工定义
- [ ] 组件包扩充
- [ ] 大数据平台
- [ ] 输出一套开源大数据平台部署文档
- [ ] 给出CDH针对不同操作系统的兼容性评估报告

